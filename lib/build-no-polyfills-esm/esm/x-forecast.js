import{g as convertTemperature,h as dateTime,j as isObjectEmpty,a as loadComponent,i as unixEpochToDate,b as classCallCheck,c as createClass,d as inherits,e as possibleConstructorReturn,f as toConsumableArray}from"./utilities-aabd0479.js";function _CustomElement(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(_CustomElement.prototype,HTMLElement.prototype),Object.setPrototypeOf(_CustomElement,HTMLElement);var template="\n  <style>\n    :host {\n      display: block;\n    }\n\n    div[data-x-forecast] h3 {\n      padding-left: 0.5rem;\n    }\n\n    div[data-x-forecast] ul {\n      list-style-type: none;\n      padding: 0 0 1rem 1.5rem;\n    }\n\n    div[data-x-forecast] ul > li {\n      padding: 0.5rem 0 0 0;\n    }\n  </style>\n\n  <div data-x-forecast>\n    <h3>Forecast</h3>\n\n    <div data-x-forecast-date-container>\n  <div/>\n",XForecast=function(t){function e(){classCallCheck(this,e);var t=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=document.createElement("div");return n.innerHTML=template,t.attachShadow({mode:"open"}).appendChild(n),t}return inherits(e,_CustomElement),createClass(e,[{key:"connectedCallback",value:function(){var t=this;this.refresh().then(function(e){t.render(e,t.days),t.currentForecast=e})}},{key:"attributeChangedCallback",value:function(t,e,n){e!==n&&null!==this.days&&("days"!==t&&"scale"!==t||this.render(this.currentForecast,this.days))}},{key:"_buildDayOfWeek",value:function(t){var e=t.dt,n=t.today,a=document.createElement("u"),r=unixEpochToDate(e);if(dateTime(r).Y("-").m("-").d().getResults()===n)a.textContent="Today:";else{var i=dateTime(r).date.toLocaleString("en-US",{weekday:"long"}),o=dateTime(r).m("/").d().getResults();a.textContent=i+" ("+o+"):"}var s=document.createElement("li");return s.appendChild(a),s}},{key:"_buildWeatherIcon",value:function(t){var e=t.description,n="https://openweathermap.org/img/w/"+t.icon+".png",a=document.createElement("img");a.setAttribute("src",n),a.setAttribute("alt",e);var r=document.createElement("li");return r.appendChild(a),r}},{key:"_buildTimeOfDayForecast",value:function(t){var e=t.timeOfDayTemp,n=t.type,a="F"===this.scale?convertTemperature(e,"cToF"):e,r=document.createElement("li");return r.textContent=n+": "+Number.parseFloat(a).toFixed(2)+"Â°"+this.scale,r}},{key:"_buildDateContainer",value:function(t,e){var n=this,a=document.createElement("div");if(a.setAttribute("data-x-forecast-date-container",""),t&&!isObjectEmpty(t)){var r=dateTime(new Date).Y("-").m("-").d("").getResults();t.length>e&&(t.length=e),t.forEach(function(t){var e=t.dt,i=t.temp,o=(t.pressure,t.humidity,t.weather),s=(t.speed,t.deg,t.clouds,t.rain,document.createElement("ul")),c=n._buildDayOfWeek({dt:e,today:r});s.appendChild(c);var u=n._buildWeatherIcon(o[0]);s.appendChild(u);var d=n._buildTimeOfDayForecast({timeOfDayTemp:i.day,type:"Day"});s.appendChild(d);var l=n._buildTimeOfDayForecast({timeOfDayTemp:i.night,type:"Night"});s.appendChild(l),a.appendChild(s)})}return a}},{key:"_getForecast",value:function(t){var e=t.appid,n=t.host,a=t.location;if(e&&n&&a)return this._serviceHandler({appid:e,host:n,location:a}).then(function(t){t.city,t.cod,t.message,t.cnt;return t.list})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,a=t.location;return fetch("https://"+n+"/data/2.5/forecast/daily?q="+a+"&mode=json&units=metric&cnt=14&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getForecast(t)}},{key:"render",value:function(t,e){var n=this.shadowRoot.querySelector("[data-x-forecast]"),a=this.shadowRoot.querySelector("[data-x-forecast] > [data-x-forecast-date-container]");n.replaceChild(this._buildDateContainer(t,e),a)}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"days",get:function(){return this.getAttribute("days")},set:function(t){this.setAttribute("days",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}}],[{key:"observedAttributes",get:function(){return["days","scale"]}}]),e}(),load=function(){return loadComponent({customElements:customElements,tagName:"x-forecast",element:XForecast})};export default XForecast;export{load};
