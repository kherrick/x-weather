import{g as convertTemperature,h as dateTime,a as loadComponent,i as to12HourTime,j as unixEpochToDate,b as classCallCheck,c as createClass,d as inherits,e as possibleConstructorReturn,f as toConsumableArray}from"./utilities-d21591dc.js";function _CustomElement(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(_CustomElement.prototype,HTMLElement.prototype),Object.setPrototypeOf(_CustomElement,HTMLElement);var template='\n  <style>\n    :host {\n      display: block;\n\n      --icon-display: inherit\n    }\n\n    [data-x-current-icon] {\n      /* defaulted for ie11 */\n      display: block;\n\n      display: var(--icon-display);\n      height: 7.5rem;\n      margin: auto;\n      width: 7.5rem;\n    }\n\n    div[data-x-current] ul {\n      list-style-type: none;\n\n      margin: auto;\n      padding: 0;\n    }\n\n    div[data-x-current] ul > li {\n      padding: 0.5rem 0 0 0;\n\n      text-align: center;\n    }\n\n    div[data-x-current] #alternateScale {\n      cursor: pointer;\n      border-bottom: 1px dotted;\n    }\n\n    #temperature {\n      font-size: 1.25rem;\n      font-weight: bold;\n    }\n\n    [data-x-current-dateTime] {\n      text-decoration: underline;\n    }\n  </style>\n\n  <div data-x-current>\n    <ul>\n      <li><span id="time"></span></li>\n      <li><span id="temperature"></span>Â°<span id="primaryScale"></span> / <span><a id="alternateScale"></a></span></li>\n    </ul>\n    <div>\n      <img data-x-current-icon alt="" id="icon"></img>\n    </div>\n  </div>\n',XCurrent=function(t){function e(){classCallCheck(this,e);var t=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=document.createElement("div");return n.innerHTML=template,t.attachShadow({mode:"open"}).appendChild(n),t}return inherits(e,_CustomElement),createClass(e,[{key:"connectedCallback",value:function(){var t=this;this.refresh().then(function(e){t.render(e),t.currentWeather=e,t.primaryScale=t.shadowRoot.querySelector("#primaryScale"),t.alternateScale=t.shadowRoot.querySelector("#alternateScale"),t.primaryScale.textContent=t.scale,t.alternateScale.textContent="C"===t.scale?"F":"C",t.alternateScale.onclick=function(){t.scale=t.alternateScale.textContent;var e=t.parentElement.querySelector("x-forecast");e&&e.setAttribute("scale",t.primaryScale.textContent)}})}},{key:"attributeChangedCallback",value:function(t,e,n){"scale"===t&&e!==n&&this.alternateScale&&this.primaryScale&&("C"===n&&(this.alternateScale.textContent="F",this.primaryScale.textContent=n),"F"===n&&(this.alternateScale.textContent="C",this.primaryScale.textContent=n),this.render(this.currentWeather))}},{key:"_getCurrentWeather",value:function(t){var e=t.appid,n=t.host,r=t.location;if(e&&n&&r)return this._serviceHandler({appid:e,host:n,location:r}).then(function(t){t.coord;var e=t.weather,n=(t.base,t.main),r=(t.visibility,t.wind,t.clouds,t.dt);t.sys,t.id,t.name,t.cod;return{iconAlt:e[0].description,iconSrc:e[0].icon,temperature:{kelvin:n.temp,celsius:convertTemperature(n.temp,"kToC"),fahrenheit:convertTemperature(n.temp,"kToF")},timestamp:r}})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,r=t.location;return fetch("https://"+n+"/data/2.5/weather?q="+r+"&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getCurrentWeather(t)}},{key:"render",value:function(t){var e=t.iconAlt,n=t.iconSrc,r=t.temperature,a=t.timestamp;this.temperature=Number.parseFloat(r["C"===this.scale?"celsius":"fahrenheit"]).toFixed(2),this.iconAlt=e,this.iconSrc="https://openweathermap.org/themes/openweathermap/assets/vendor/owm/img/widgets/"+n+".png",this.timestamp=a}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"iconAlt",set:function(t){this.shadowRoot.querySelector("#icon").setAttribute("alt",t)}},{key:"iconSrc",set:function(t){this.shadowRoot.querySelector("#icon").src=t}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}},{key:"temperature",set:function(t){this.setAttribute("temperature",t),this.shadowRoot.querySelector("#temperature").textContent=t}},{key:"timestamp",set:function(t){this.shadowRoot.querySelector("#time").innerHTML="\n      <div data-x-current-dateTime>\n        "+to12HourTime(dateTime(unixEpochToDate(t)).H(":").M(":").S().getResults())+" ("+dateTime(new Date).m("-").d().getResults()+"):\n      </div>\n    "}}],[{key:"observedAttributes",get:function(){return["scale"]}}]),e}(),load=function(){return loadComponent({customElements:customElements,tagName:"x-current",element:XCurrent})};export default XCurrent;export{load};
