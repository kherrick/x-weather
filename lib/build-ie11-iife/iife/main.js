var Main=function(){"use strict";var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},o=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"cToF",n=function(t){return t+273.15},i=function(t){return t-273.15},r=function(t){return 1.8*t+32},a=function(t){return 5*(t-32)/9};return{cToK:n,kToC:i,cToF:r,fToC:a,kToF:function(t){return r(i(t))},fToK:function(t){return n(a(t))}}[e](t)},t=function(t){var e=t.customElements,n=t.tagName,i=t.element,r=function(t){var e=t.customElements,n=t.tagName,i=t.element;e.define(n,i)};window.customElements?r({customElements:e,tagName:n,element:i}):document.addEventListener("WebComponentsReady",function(){r({customElements:e,tagName:n,element:i})})},s=function(t){return new Date(1e3*t)},c=function(t){return{date:t,results:"",getResults:function(){return this.results},getTimeStamp:function(){return this.date.getTime()},Y:function(t){return this.results+=this.date.getFullYear(),this.sep(t)&&(this.results+=t),this},m:function(t){return this.results+=this.pad(this.date.getMonth()+1),this.sep(t)&&(this.results+=t),this},d:function(t){return this.results+=this.pad(this.date.getDate()),this.sep(t)&&(this.results+=t),this},H:function(t){return this.results+=this.pad(this.date.getHours()),this.sep(t)&&(this.results+=t),this},M:function(t){return this.results+=this.pad(this.date.getMinutes()),this.sep(t)&&(this.results+=t),this},S:function(t){return this.results+=this.pad(this.date.getSeconds()),this.sep(t)&&(this.results+=t),this},pad:function(t){return t<10?"0"+t:t},sep:function(t){return!!t}}},n=function(t){function n(){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --icon-display: inherit\n    }\n\n    [data-x-current-icon] {\n      display: var(--icon-display);\n      float: left;\n      height: 7.5rem;\n      width: 7.5rem;\n    }\n\n    div[data-x-current] ul {\n      list-style-type: none;\n\n      margin-bottom: 0;\n      padding: 0 0 0 1.5rem;\n    }\n\n    div[data-x-current] ul > li {\n      padding: 0.5rem 0 0 0;\n    }\n\n    div[data-x-current] #alternateScale {\n      cursor: pointer;\n      border-bottom: 1px dotted;\n    }\n  </style>\n\n  <div data-x-current>\n    <ul>\n      <li><b id="time"></b></li>\n      <li><span id="temperature"></span>°<span id="primaryScale"></span> / <span><a id="alternateScale"></a></span></li>\n    </ul>\n    <img data-x-current-icon alt="" id="icon"></img>\n  </div>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return r(n,t),e(n,[{key:"connectedCallback",value:function(){var e=this;this.refresh().then(function(t){e.render(t),e.currentWeather=t,e.primaryScale=e.shadowRoot.querySelector("#primaryScale"),e.alternateScale=e.shadowRoot.querySelector("#alternateScale"),e.primaryScale.textContent=e.scale,e.alternateScale.textContent="C"===e.scale?"F":"C",e.alternateScale.onclick=function(){e.scale=e.alternateScale.textContent;var t=e.parentElement.querySelector("x-forecast");t&&t.setAttribute("scale",e.primaryScale.textContent)}})}},{key:"attributeChangedCallback",value:function(t,e,n){"scale"===t&&e!==n&&this.alternateScale&&this.primaryScale&&("C"===n&&(this.alternateScale.textContent="F",this.primaryScale.textContent=n),"F"===n&&(this.alternateScale.textContent="C",this.primaryScale.textContent=n),this.render(this.currentWeather))}},{key:"_getCurrentWeather",value:function(t){var e=t.appid,n=t.host,i=t.location;if(e&&n&&i)return this._serviceHandler({appid:e,host:n,location:i}).then(function(t){t.coord;var e=t.weather,n=(t.base,t.main),i=(t.visibility,t.wind,t.clouds,t.dt);t.sys,t.id,t.name,t.cod;return{iconAlt:e[0].description,iconSrc:e[0].icon,temperature:{kelvin:n.temp,celsius:o(n.temp,"kToC"),fahrenheit:o(n.temp,"kToF")},timestamp:i}})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,i=t.location;return fetch("https://"+n+"/data/2.5/weather?q="+i+"&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getCurrentWeather(t)}},{key:"render",value:function(t){var e=t.iconAlt,n=t.iconSrc,i=t.temperature,r=t.timestamp;this.temperature=Number.parseFloat(i["C"===this.scale?"celsius":"fahrenheit"]).toFixed(2),this.iconAlt=e,this.iconSrc="https://openweathermap.org/themes/openweathermap/assets/vendor/owm/img/widgets/"+n+".png",this.timestamp=r}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"iconAlt",set:function(t){this.shadowRoot.querySelector("#icon").setAttribute("alt",t)}},{key:"iconSrc",set:function(t){this.shadowRoot.querySelector("#icon").src=t}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}},{key:"temperature",set:function(t){this.setAttribute("temperature",t),this.shadowRoot.querySelector("#temperature").textContent=t}},{key:"timestamp",set:function(t){this.shadowRoot.querySelector("#time").textContent=function(t){var e=String(t).split(":"),n=Number(e[0]),i=Number(e[1])||0,r=Number(e[2])||0;(n<0||23<n||i<0||59<i||r<0||59<r)&&(n=i=r=0);var a="12";return 0<n&&n<=12&&(a=String(n)),12<n&&(a=String(n%a)),a+=i<10?":0"+i:":"+i,a+=r<10?":0"+r:":"+r,a+=12<=n?" PM":" AM"}(c(s(t)).H(":").M(":").S().getResults())}}],[{key:"observedAttributes",get:function(){return["scale"]}}]),n}(HTMLElement),u=function(t){function n(){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --icon-display: inherit\n    }\n\n    [data-x-forecast-icon] {\n      display: var(--icon-display);\n    }\n\n    ul[data-x-forecast-item] {\n      list-style-type: none;\n\n      padding: 0 0 1rem 1.5rem;\n    }\n\n    ul[data-x-forecast-item] > li {\n      padding: 0.5rem 0 0 0;\n    }\n  </style>\n\n  <ul data-x-forecast-item>\n    <li>\n      <u id="forecastDate"></u>\n    </li>\n    <li data-x-forecast-icon>\n      <img id="icon" />\n    </li>\n    <li>Day: <span id="day"></span>°<span data-scale></span></li>\n    <li>Night: <span id="night"></span>°<span data-scale></span></li>\n  </ul>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return r(n,t),e(n,[{key:"attributeChangedCallback",value:function(t,e,n){switch(t){case"day":this.shadowRoot.getElementById("day").textContent=n;break;case"description":this.shadowRoot.getElementById("icon").alt=n;break;case"forecast-date":this.shadowRoot.getElementById("forecastDate").textContent=n;break;case"icon":this.shadowRoot.getElementById("icon").src=n;break;case"night":this.shadowRoot.getElementById("night").textContent=n;break;case"scale":this.shadowRoot.querySelectorAll("[data-scale]").forEach(function(t){t.textContent=n})}}}],[{key:"observedAttributes",get:function(){return["day","description","forecast-date","icon","night","scale"]}}]),n}(HTMLElement),l=function(t){function n(){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML="\n  <style>\n    :host {\n      display: block;\n\n      --x-forecast-item-float: inherit;\n      --x-forecast-item-width: inherit;\n    }\n\n    x-forecast-item {\n      float: var(--x-forecast-item-float);\n      width: var(--x-forecast-item-width);\n    }\n  </style>\n\n  <div data-x-forecast>\n    <div data-x-forecast-date-container>\n  <div/>\n",t.attachShadow({mode:"open"}).appendChild(e),t}return r(n,t),e(n,[{key:"connectedCallback",value:function(){var e=this;this.refresh().then(function(t){e.render(t,e.days),e.currentForecast=t})}},{key:"attributeChangedCallback",value:function(t,e,n){e!==n&&null!==this.days&&("days"!==t&&"scale"!==t||this.render(this.currentForecast,this.days))}},{key:"_buildDateContainer",value:function(t,e){var n,a=this,o=document.createElement("div");if(o.setAttribute("data-x-forecast-date-container",""),t&&(n=t,0!==Object.keys(n).length||n.constructor!==Object)){var s=c(new Date).Y("-").m("-").d("").getResults();t.length>e&&(t.length=e),t.forEach(function(t){var e=t.dt,n=t.temp,i=(t.pressure,t.humidity,t.weather),r=(t.speed,t.deg,t.clouds,t.rain,document.createElement("x-forecast-item"));r.setAttribute("day",a._convertForecast({scale:a.scale,timeOfDayTemp:n.day})),r.setAttribute("description",i[0].description),r.setAttribute("forecast-date",a._getDayOfWeek({dt:e,today:s})),r.setAttribute("icon","https://openweathermap.org/img/w/"+i[0].icon+".png"),r.setAttribute("night",a._convertForecast({scale:a.scale,timeOfDayTemp:n.night})),r.setAttribute("scale",a.scale),o.appendChild(r)})}return o}},{key:"_convertForecast",value:function(t){var e=t.scale,n=t.timeOfDayTemp;return""+Number.parseFloat("F"===e?o(n,"cToF"):n).toFixed(2)}},{key:"_getDayOfWeek",value:function(t){var e=t.dt,n=t.today,i=s(e),r=c(i).Y("-").m("-").d().getResults(),a=c(i).m("/").d().getResults();return r===n?"Today ("+a+"):":c(i).date.toLocaleString("en-US",{weekday:"long"})+" ("+a+"):"}},{key:"_getForecast",value:function(t){var e=t.appid,n=t.host,i=t.location;if(e&&n&&i)return this._serviceHandler({appid:e,host:n,location:i}).then(function(t){t.city,t.cod,t.message,t.cnt;return t.list})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,i=t.location;return fetch("https://"+n+"/data/2.5/forecast/daily?q="+i+"&mode=json&units=metric&cnt=14&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getForecast(t)}},{key:"render",value:function(t,e){var n=this.shadowRoot.querySelector("[data-x-forecast]"),i=this.shadowRoot.querySelector("[data-x-forecast] > [data-x-forecast-date-container]");n.replaceChild(this._buildDateContainer(t,e),i)}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"days",get:function(){return this.getAttribute("days")},set:function(t){this.setAttribute("days",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}}],[{key:"observedAttributes",get:function(){return["days","scale"]}}]),n}(HTMLElement),h=function(t){function n(){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --x-weather-location-margin: inherit;\n    }\n\n    div[data-x-weather] #location {\n      border: 0;\n      font-style: italic;\n      margin: var(--x-weather-location-margin);\n      padding: 0 2.5% 0 0;\n      width: 95%;\n    }\n  </style>\n\n  <div data-x-weather>\n    <div><input id="location"></input></div>\n\n    <slot></slot>\n  </div>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return r(n,t),e(n,[{key:"connectedCallback",value:function(){var e=this;this._upgradeProperty("appid"),this._upgradeProperty("host"),this._upgradeProperty("location"),this.xCurrent=this.querySelector("x-current"),this.xForecast=this.querySelector("x-forecast"),this._renderLocation(this.location);var t=this.shadowRoot.querySelector("#location");t.addEventListener("change",function(){e.location=t.value,e.xCurrent.refresh().then(function(t){e.xCurrent.render(t),e.xCurrent.currentWeather=t}),e.xForecast.refresh().then(function(t){e.xForecast.render(t),e.xForecast.currentForecast=t})})}},{key:"attributeChangedCallback",value:function(t,e,n){(e!==n&&"appid"===t||"host"===t||"location"===t)&&("location"===t&&this._renderLocation(this.location),this.xCurrent&&this.xCurrent.setAttribute(t,n),this.xForecast&&this.xForecast.setAttribute(t,n))}},{key:"_renderLocation",value:function(t){this.shadowRoot.querySelector("#location").value=t}},{key:"_upgradeProperty",value:function(t){if(this.hasOwnProperty(t)){var e=this[t];delete this[t],this[t]=e}}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}}],[{key:"observedAttributes",get:function(){return["appid","host","location"]}}]),n}(HTMLElement);return t({customElements:customElements,tagName:"x-current",element:n}),t({customElements:customElements,tagName:"x-forecast-item",element:u}),t({customElements:customElements,tagName:"x-forecast",element:l}),t({customElements:customElements,tagName:"x-weather",element:h}),{XCurrent:n,XForecastItem:u,XForecast:l,XWeather:h}}();
