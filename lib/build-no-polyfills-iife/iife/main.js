var Main=function(){"use strict";var r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"cToF",n=function(t){return t+273.15},r=function(t){return t-273.15},i=function(t){return 1.8*t+32},o=function(t){return 5*(t-32)/9};return{cToK:n,kToC:r,cToF:i,fToC:o,kToF:function(t){return i(r(t))},fToK:function(t){return n(o(t))}}[e](t)},t=function(t){var e=t.customElements,n=t.tagName,r=t.element,i=function(t){var e=t.customElements,n=t.tagName,r=t.element;e.define(n,r)};window.customElements?i({customElements:e,tagName:n,element:r}):document.addEventListener("WebComponentsReady",function(){i({customElements:e,tagName:n,element:r})})},s=function(t){return new Date(1e3*t)},c=function(t){return{date:t,results:"",getResults:function(){return this.results},getTimeStamp:function(){return this.date.getTime()},Y:function(t){return this.results+=this.date.getFullYear(),this.sep(t)&&(this.results+=t),this},m:function(t){return this.results+=this.pad(this.date.getMonth()+1),this.sep(t)&&(this.results+=t),this},d:function(t){return this.results+=this.pad(this.date.getDate()),this.sep(t)&&(this.results+=t),this},H:function(t){return this.results+=this.pad(this.date.getHours()),this.sep(t)&&(this.results+=t),this},M:function(t){return this.results+=this.pad(this.date.getMinutes()),this.sep(t)&&(this.results+=t),this},S:function(t){return this.results+=this.pad(this.date.getSeconds()),this.sep(t)&&(this.results+=t),this},pad:function(t){return t<10?"0"+t:t},sep:function(t){return!!t}}};function u(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(u.prototype,HTMLElement.prototype),Object.setPrototypeOf(u,HTMLElement);var n=function(t){function n(){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --icon-display: inherit\n    }\n\n    [data-x-current-icon] {\n      display: var(--icon-display);\n      float: left;\n      height: 7.5rem;\n      width: 7.5rem;\n    }\n\n    div[data-x-current] ul {\n      list-style-type: none;\n\n      margin-bottom: 0;\n      padding: 0 0 0 1.5rem;\n    }\n\n    div[data-x-current] ul > li {\n      padding: 0.5rem 0 0 0;\n    }\n\n    div[data-x-current] #alternateScale {\n      cursor: pointer;\n      border-bottom: 1px dotted;\n    }\n  </style>\n\n  <div data-x-current>\n    <ul>\n      <li><b id="time"></b></li>\n      <li><span id="temperature"></span>°<span id="primaryScale"></span> / <span><a id="alternateScale"></a></span></li>\n    </ul>\n    <img data-x-current-icon alt="" id="icon"></img>\n  </div>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return i(n,u),e(n,[{key:"connectedCallback",value:function(){var e=this;this.refresh().then(function(t){e.render(t),e.currentWeather=t,e.primaryScale=e.shadowRoot.querySelector("#primaryScale"),e.alternateScale=e.shadowRoot.querySelector("#alternateScale"),e.primaryScale.textContent=e.scale,e.alternateScale.textContent="C"===e.scale?"F":"C",e.alternateScale.onclick=function(){e.scale=e.alternateScale.textContent;var t=e.parentElement.querySelector("x-forecast");t&&t.setAttribute("scale",e.primaryScale.textContent)}})}},{key:"attributeChangedCallback",value:function(t,e,n){"scale"===t&&e!==n&&this.alternateScale&&this.primaryScale&&("C"===n&&(this.alternateScale.textContent="F",this.primaryScale.textContent=n),"F"===n&&(this.alternateScale.textContent="C",this.primaryScale.textContent=n),this.render(this.currentWeather))}},{key:"_getCurrentWeather",value:function(t){var e=t.appid,n=t.host,r=t.location;if(e&&n&&r)return this._serviceHandler({appid:e,host:n,location:r}).then(function(t){t.coord;var e=t.weather,n=(t.base,t.main),r=(t.visibility,t.wind,t.clouds,t.dt);t.sys,t.id,t.name,t.cod;return{iconAlt:e[0].description,iconSrc:e[0].icon,temperature:{kelvin:n.temp,celsius:a(n.temp,"kToC"),fahrenheit:a(n.temp,"kToF")},timestamp:r}})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,r=t.location;return fetch("https://"+n+"/data/2.5/weather?q="+r+"&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getCurrentWeather(t)}},{key:"render",value:function(t){var e=t.iconAlt,n=t.iconSrc,r=t.temperature,i=t.timestamp;this.temperature=Number.parseFloat(r["C"===this.scale?"celsius":"fahrenheit"]).toFixed(2),this.iconAlt=e,this.iconSrc="https://openweathermap.org/themes/openweathermap/assets/vendor/owm/img/widgets/"+n+".png",this.timestamp=i}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"iconAlt",set:function(t){this.shadowRoot.querySelector("#icon").setAttribute("alt",t)}},{key:"iconSrc",set:function(t){this.shadowRoot.querySelector("#icon").src=t}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}},{key:"temperature",set:function(t){this.setAttribute("temperature",t),this.shadowRoot.querySelector("#temperature").textContent=t}},{key:"timestamp",set:function(t){this.shadowRoot.querySelector("#time").textContent=function(t){var e=String(t).split(":"),n=Number(e[0]),r=Number(e[1])||0,i=Number(e[2])||0;(n<0||23<n||r<0||59<r||i<0||59<i)&&(n=r=i=0);var o="12";return 0<n&&n<=12&&(o=String(n)),12<n&&(o=String(n%o)),o+=r<10?":0"+r:":"+r,o+=i<10?":0"+i:":"+i,o+=12<=n?" PM":" AM"}(c(s(t)).H(":").M(":").S().getResults())}}],[{key:"observedAttributes",get:function(){return["scale"]}}]),n}();function l(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(l.prototype,HTMLElement.prototype),Object.setPrototypeOf(l,HTMLElement);var h=function(t){function n(){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --icon-display: inherit\n    }\n\n    [data-x-forecast-icon] {\n      display: var(--icon-display);\n    }\n\n    ul[data-x-forecast-item] {\n      list-style-type: none;\n\n      padding: 0 0 1rem 1.5rem;\n    }\n\n    ul[data-x-forecast-item] > li {\n      padding: 0.5rem 0 0 0;\n    }\n  </style>\n\n  <ul data-x-forecast-item>\n    <li>\n      <u id="forecastDate"></u>\n    </li>\n    <li data-x-forecast-icon>\n      <img id="icon" />\n    </li>\n    <li>Day: <span id="day"></span>°<span data-scale></span></li>\n    <li>Night: <span id="night"></span>°<span data-scale></span></li>\n  </ul>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return i(n,l),e(n,[{key:"attributeChangedCallback",value:function(t,e,n){switch(t){case"day":this.shadowRoot.getElementById("day").textContent=n;break;case"description":this.shadowRoot.getElementById("icon").alt=n;break;case"forecast-date":this.shadowRoot.getElementById("forecastDate").textContent=n;break;case"icon":this.shadowRoot.getElementById("icon").src=n;break;case"night":this.shadowRoot.getElementById("night").textContent=n;break;case"scale":this.shadowRoot.querySelectorAll("[data-scale]").forEach(function(t){t.textContent=n})}}}],[{key:"observedAttributes",get:function(){return["day","description","forecast-date","icon","night","scale"]}}]),n}();function d(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(d.prototype,HTMLElement.prototype),Object.setPrototypeOf(d,HTMLElement);var p=function(t){function n(){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML="\n  <style>\n    :host {\n      display: block;\n\n      --x-forecast-item-float: inherit;\n      --x-forecast-item-width: inherit;\n    }\n\n    x-forecast-item {\n      float: var(--x-forecast-item-float);\n      width: var(--x-forecast-item-width);\n    }\n  </style>\n\n  <div data-x-forecast>\n    <div data-x-forecast-date-container>\n  <div/>\n",t.attachShadow({mode:"open"}).appendChild(e),t}return i(n,d),e(n,[{key:"connectedCallback",value:function(){var e=this;this.refresh().then(function(t){e.render(t,e.days),e.currentForecast=t})}},{key:"attributeChangedCallback",value:function(t,e,n){e!==n&&null!==this.days&&("days"!==t&&"scale"!==t||this.render(this.currentForecast,this.days))}},{key:"_buildDateContainer",value:function(t,e){var n,o=this,a=document.createElement("div");if(a.setAttribute("data-x-forecast-date-container",""),t&&(n=t,0!==Object.keys(n).length||n.constructor!==Object)){var s=c(new Date).Y("-").m("-").d("").getResults();t.length>e&&(t.length=e),t.forEach(function(t){var e=t.dt,n=t.temp,r=(t.pressure,t.humidity,t.weather),i=(t.speed,t.deg,t.clouds,t.rain,document.createElement("x-forecast-item"));i.setAttribute("day",o._convertForecast({scale:o.scale,timeOfDayTemp:n.day})),i.setAttribute("description",r[0].description),i.setAttribute("forecast-date",o._getDayOfWeek({dt:e,today:s})),i.setAttribute("icon","https://openweathermap.org/img/w/"+r[0].icon+".png"),i.setAttribute("night",o._convertForecast({scale:o.scale,timeOfDayTemp:n.night})),i.setAttribute("scale",o.scale),a.appendChild(i)})}return a}},{key:"_convertForecast",value:function(t){var e=t.scale,n=t.timeOfDayTemp;return""+Number.parseFloat("F"===e?a(n,"cToF"):n).toFixed(2)}},{key:"_getDayOfWeek",value:function(t){var e=t.dt,n=t.today,r=s(e),i=c(r).Y("-").m("-").d().getResults(),o=c(r).m("/").d().getResults();return i===n?"Today ("+o+"):":c(r).date.toLocaleString("en-US",{weekday:"long"})+" ("+o+"):"}},{key:"_getForecast",value:function(t){var e=t.appid,n=t.host,r=t.location;if(e&&n&&r)return this._serviceHandler({appid:e,host:n,location:r}).then(function(t){t.city,t.cod,t.message,t.cnt;return t.list})}},{key:"_serviceHandler",value:function(t){var e=t.appid,n=t.host,r=t.location;return fetch("https://"+n+"/data/2.5/forecast/daily?q="+r+"&mode=json&units=metric&cnt=14&appid="+e,{method:"GET"}).then(function(t){if(t.ok)return t.json()})}},{key:"refresh",value:function(){var t={appid:this.parentElement.getAttribute("appid"),host:this.parentElement.getAttribute("host"),location:this.parentElement.getAttribute("location")};return this._getForecast(t)}},{key:"render",value:function(t,e){var n=this.shadowRoot.querySelector("[data-x-forecast]"),r=this.shadowRoot.querySelector("[data-x-forecast] > [data-x-forecast-date-container]");n.replaceChild(this._buildDateContainer(t,e),r)}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"days",get:function(){return this.getAttribute("days")},set:function(t){this.setAttribute("days",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}},{key:"scale",get:function(){return this.getAttribute("scale")},set:function(t){this.setAttribute("scale",t)}}],[{key:"observedAttributes",get:function(){return["days","scale"]}}]),n}();function f(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}Object.setPrototypeOf(f.prototype,HTMLElement.prototype),Object.setPrototypeOf(f,HTMLElement);var m=function(t){function n(){r(this,n);var t=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),e=document.createElement("div");return e.innerHTML='\n  <style>\n    :host {\n      display: block;\n\n      --x-weather-location-margin: inherit;\n    }\n\n    div[data-x-weather] #location {\n      border: 0;\n      font-style: italic;\n      margin: var(--x-weather-location-margin);\n      padding: 0 2.5% 0 0;\n      width: 95%;\n    }\n  </style>\n\n  <div data-x-weather>\n    <div><input id="location"></input></div>\n\n    <slot></slot>\n  </div>\n',t.attachShadow({mode:"open"}).appendChild(e),t}return i(n,f),e(n,[{key:"connectedCallback",value:function(){var e=this;this._upgradeProperty("appid"),this._upgradeProperty("host"),this._upgradeProperty("location"),this.xCurrent=this.querySelector("x-current"),this.xForecast=this.querySelector("x-forecast"),this._renderLocation(this.location);var t=this.shadowRoot.querySelector("#location");t.addEventListener("change",function(){e.location=t.value,e.xCurrent.refresh().then(function(t){e.xCurrent.render(t),e.xCurrent.currentWeather=t}),e.xForecast.refresh().then(function(t){e.xForecast.render(t),e.xForecast.currentForecast=t})})}},{key:"attributeChangedCallback",value:function(t,e,n){(e!==n&&"appid"===t||"host"===t||"location"===t)&&("location"===t&&this._renderLocation(this.location),this.xCurrent&&this.xCurrent.setAttribute(t,n),this.xForecast&&this.xForecast.setAttribute(t,n))}},{key:"_renderLocation",value:function(t){this.shadowRoot.querySelector("#location").value=t}},{key:"_upgradeProperty",value:function(t){if(this.hasOwnProperty(t)){var e=this[t];delete this[t],this[t]=e}}},{key:"appid",get:function(){return this.getAttribute("appid")},set:function(t){this.setAttribute("appid",t)}},{key:"host",get:function(){return this.getAttribute("host")},set:function(t){this.setAttribute("host",t)}},{key:"location",get:function(){return this.getAttribute("location")},set:function(t){this.setAttribute("location",t)}}],[{key:"observedAttributes",get:function(){return["appid","host","location"]}}]),n}();return t({customElements:customElements,tagName:"x-current",element:n}),t({customElements:customElements,tagName:"x-forecast-item",element:h}),t({customElements:customElements,tagName:"x-forecast",element:p}),t({customElements:customElements,tagName:"x-weather",element:m}),{XCurrent:n,XForecastItem:h,XForecast:p,XWeather:m}}();
